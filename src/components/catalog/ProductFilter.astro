---
const categories = ['All', 'Home Decor', 'Electronics', 'Fashion', 'Gifts'];
---

<div class="filter-container">
  <h3>Categories</h3>
  <div class="filter-group">
    {categories.map((cat) => (
      <button 
        class={`filter-btn ${cat === 'All' ? 'active' : ''}`}
        data-category={cat}
      >
        {cat}
      </button>
    ))}
  </div>

  <h3>Price Range</h3>
  <div class="filter-group">
    <button class="filter-btn active" data-max="9999">Show All</button>
    <button class="filter-btn" data-max="200">Under $200 TTD</button>
    <button class="filter-btn" data-max="500">Under $500 TTD</button>
  </div>
</div>

<style>
  .filter-container {
    background-color: var(--surface);
    padding: 2rem;
    border-radius: var(--radius);
    border: 1px solid var(--border);
    height: sticky;
    top: calc(var(--header-height) + 2rem);
  }

  h3 {
    font-family: 'Inter', sans-serif;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 1.25rem;
    color: var(--text-light);
  }

  h3:not(:first-child) {
    margin-top: 2.5rem;
  }

  .filter-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .filter-btn {
    background: none;
    border: 1px solid transparent;
    text-align: left;
    padding: 0.6rem 1rem;
    border-radius: calc(var(--radius) / 2);
    cursor: pointer;
    font-size: 0.95rem;
    color: var(--text);
    transition: var(--transition);
  }

  .filter-btn:hover {
    background-color: rgba(0, 0, 0, 0.05);
    color: var(--primary);
  }

  .filter-btn.active {
    background-color: var(--primary);
    color: white;
    font-weight: 600;
  }
</style>

<script>
  // Filter logic will be handled by a global store or state manager
  import { map } from 'nanostores';

  const filterStore = map({
    category: 'All',
    maxPrice: 9999,
  });

  const buttons = document.querySelectorAll('.filter-btn');
  buttons.forEach(btn => {
    btn.addEventListener('click', () => {
      const parent = btn.parentElement;
      const category = btn.getAttribute('data-category');
      const maxPrice = btn.getAttribute('data-max');

      // Update active state in UI
      parent?.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      // Update store
      if (category) filterStore.setKey('category', category);
      if (maxPrice) filterStore.setKey('maxPrice', parseInt(maxPrice));

      // Dispatch custom event for catalog to listen
      window.dispatchEvent(new CustomEvent('filter-change', { 
        detail: filterStore.get() 
      }));
    });
  });
</script>
